<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head th:insert="partials/head :: head('BotaniBuddy Home')"></head>
<!--commenting-->
<body>
<!--Navbar Start-->
<header th:replace="partials/navbar :: navbar"></header>
<!-- Navbar End -->

<div class="d-flex container create justify-content-center align-content-center">
<!--Start Profile-->
    <div class="container emp-profile">
        <form method="post">
<!--Start Row-->
            <div class="row">
                <div class="col-md-4">
<!--Start Profile Img-->
                    <form class="form-horizontal flex-grow-1"
                          th:action="@{/users/profile}"
                          th:object="${user}" th:method="post"
                          enctype="multipart/form-data"
                    >
                    <div class="profile-img">
                        <div class="panel-body text-center">
                            <div>
                                <img class="img-circle profile-avatar" th:src="${user.profile_pic}" id="profile-img" height ="64px" alt="User avatar">
                            </div>
                        </div>
                    </div>
                    </form>
                </div>
<!--End Profile Img-->

<!--Start Profile Header-->
                <div class="col-md-6">
                    <div class="profile-head">
                        <h5  class="subtitle" th:text="${user.first_name} + ' ' + ${user.last_name}"></h5>
                        <h6 class="quote" th:text="${user.username}"></h6>
                        <h6 class="quote" th:text="'Date Joined: ' + ${user.created_at}"></h6>

<!--Start Profile Tabs-->
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="home-tab" data-toggle="tab" th:href="@{#profile}" role="tab" aria-controls="profile" aria-selected="true">User Info</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="garden-tab" data-toggle="tab" th:href="@{#garden}" role="tab" aria-controls="profile" aria-selected="false">Your Garden</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="journal-tab" data-toggle="tab" th:href="@{#journal}" role="tab" aria-controls="profile" aria-selected="false">Plant Journal</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="weather-tab" data-toggle="tab" th:href="@{#weather}" role="tab" aria-controls="profile" aria-selected="false">Weather</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="friends-tab" data-toggle="tab" th:href="@{#friends}" role="tab" aria-controls="profile" aria-selected="false">Friends</a>
                        </li>
                    </ul>
<!--End Profile Tabs-->

                    </div>
            </div>
<!--End Profile Header-->
<!--Start EDIT PROFILE BUTTON-->
            <div class="col-md-2">
                <a type="submit"  class="profile-edit-btn" name="btnAddMore" th:href="@{/users/{id}/edit(id=${user.id})}">Edit Profile</a>
            </div>
<!--End EDIT PROFILE BUTTON-->
            </div>
<!--End Row-->

<!--Start Tab Panels-->
            <div class="row">
<!--EMPTY DIV FOR MAINTAINING FORMAT OF PAGE-->
                <div class="col-md-4">
                    <div class="profile-work">

                    </div>
                </div>
<!--End EMPTY DIV FOR MAINTAINING FORMAT OF PAGE-->

                <div class="col-md-8">
                    <div class="tab-content profile-tab" id="myTabContent">
                     <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="home-tab">
                        <div class="row">
                            <div class="col-md-6">
                                <label>User Id</label>
                            </div>
                            <div class="col-md-6">
                                <p class="quote" th:text="${user.username}"></p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label>Name</label>
                            </div>
                            <div class="col-md-6">
                                <p  class="subtitle" th:text="${user.first_name} + ' ' + ${user.last_name}"></p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label>Email</label>
                            </div>
                            <div class="col-md-6">
                                <p class="quote" th:text="${user.email}"></p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label>City</label>
                            </div>
                            <div class="col-md-6">
                                <p class="quote" th:text="${user.city}"></p>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="garden" role="tabpanel" aria-labelledby="garden-tab">
                        <div class="row">
                            <div class="col-md-6">
                                <div>
                                    <div th:if="${not #lists.isEmpty(userPlants)}">
                                        <div class="column" th:each="plant : ${userPlants}">
                                            <a th:href="@{/plants/garden/{id}(id=${plant.id})}">
                                                <span th:text="${plant.plant.name}"></span>
                                            </a>
                                            <p><span th:text="${plant.sun_amount}"></span></p>
                                            <p><span th:text="${plant.water_interval}"></span> Day(s)</p>
                                            <p><span th:text="${plant.getSun_tip}"></span></p>
                                            <p><span th:text="${plant.getWater_tip}"></span></p>

                                            <!-- button for delete plant path -->
                                            <div class="row">
                                                <a th:href="@{/plants/quickWater/{id}(id=${plant.id})}">Watered</a>
                                            </div>
                                            <div class="row">
                                                <a style="color: red;" th:href="@{/plants/{id}/delete(id=${plant.id})}">
                                                    Delete</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div th:unless="${not #lists.isEmpty(userPlants)}">

                                        <form action="#" th:action="@{/plants/search}" method="post">
                                            <label>Add A Plant!
                                                <input style="color: black;" type="text" name="query" placeholder="Lookin' for a plant ?" required autocomplete="on">
                                            </label>
                                            <input style="color: black;" value="Search" type="submit">
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="journal" role="tabpanel" aria-labelledby="journal-tab">

<!--                        recentPlantLogs-->
                        <div th:if="${not #lists.isEmpty(recentPlantLogs)}">
                            <div class="row justify-content-between">

                                <div th:each="plant : ${userPlants}">
                                    <div th:if="${not #lists.isEmpty(plant.getPlantLogs())}">
                                        <div class="row">
                                            <div class="col">
                                                <a th:href="@{/plants/garden/{id}(id=${plant.id})}">
                                                    <span th:text="${plant.plant.name}"></span>
                                                </a>
                                            </div>
                                            <div style=" max-width: fit-content; border-radius: 99px; color: white;"
                                                 class="col bg-primary"
                                                 th:text="${plant.getPlantLogs().size()}"></div>
                                        </div>
                                        <div class="col">
                                            <div class="row">
                                                <div class="col">
                                                    <p th:if="${not #lists.isEmpty(plant.getPlantLogs())}"
                                                       th:text="${plant.getPlantLogs().get(plant.getPlantLogs().size()-1).created_at.getMonth()}"></p>
                                                    <p th:if="${not #lists.isEmpty(plant.getPlantLogs())}"
                                                       th:text="${plant.getPlantLogs().get(plant.getPlantLogs().size()-1).created_at.getDayOfMonth()}"></p>
                                                </div>
                                                <div class="col">
                                                    <p th:if="${not #lists.isEmpty(plant.getPlantLogs())}"
                                                       th:text="${plant.getPlantLogs().get(plant.getPlantLogs().size()-1).title}"></p>
                                                </div>
                                            </div>
                                            <div>
                                                <p th:if="${not #lists.isEmpty(plant.getPlantLogs())}"
                                                   th:text="${plant.getPlantLogs().get(plant.getPlantLogs().size()-1).content}"></p>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>
                        <div th:unless="${not #lists.isEmpty(recentPlantLogs)}">
                            <p>no logs</p>
                        </div>

                        </div>
                    <div class="tab-pane fade" id="weather" role="tabpanel" aria-labelledby="weather-tab">
                        <h3 class="subtitle">Weather Banner</h3>
                        <div th:if="${weather}">
                            <p th:text="'Temp: ' + ${weather.getTempAvg()}"></p>
                            <p th:text="'Humidity: ' + ${weather.getHumidity()}"></p>
                            <p th:text="'Sunrise: ' + ${weather.getSunrise()}"></p>
                            <p th:text="'Sunset: ' + ${weather.getSunset()}"></p>
                            <p th:text="'Cloudiness: ' + ${weather.getCloudiness()}"></p>
                            <p th:text="'Description: ' + ${weather.getCloudDesc()}"></p>
                            <p th:text="'Wind Speed: ' + ${weather.getWindSpeed()}"></p>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="friends" role="tabpanel" aria-labelledby="friends-tab">
                        <!--    Friends Request Placeholder-->
                        <div>
                            <h3 class="subtitle">Friend Requests</h3>
                            <div class="row justify-content-between">
                                <div class="column" th:each="request : ${friendsRequest}">
                                    <p th:text="${request.id}"></p>
                                    <p th:text="${request.username}"></p>
                                    <p th:text="${request.last_name}"></p>
                                    <p th:text="${request.username}"></p>
                                    <p th:text="${request.email}"></p>
                                    <a th:href="@{/friends/accept/{id}(id=${request.id})}">Accept</a>
                                    <a th:href="@{/friends/ignore/{id}(id=${request.id})}">Ignore</a>
                                </div>
                                <h3 class="subtitle">Friends</h3>
                                <div class="column" th:each="friend : ${friends}">
<!--                                <p th:text="${friend.first_name}"></p>-->
<!--                                <p th:text="${friend.last_name}"></p>-->
                                    <div class="row">
                                        <p style="color: black;">
                                            [[${friend.username}]]
                                            <span style="color: blue;" th:text="${friend.email}"></span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>

            <div th:if="${not #lists.isEmpty(outdoorPlants)}">
                <h3 class="subtitle">Outdoor Plant Warning</h3>
                <div class="row justify-content-between">
                    <div class="column" th:each="plant : ${outdoorPlants}">
                        <p> Plant Name: <span th:text="${plant.plant.name}"></span></p>
                        <p> Req'd Sun Amount: <span  th:text="${plant.sun_amount}"></span></p>
                        <p> Water Every <span th:text="${plant.water_interval}"></span> Day(s)</p>
                        <p> BotaniBuddy SunTip: <span  th:text="${plant.getSun_tip}"></span></p>
                        <p> BotaniBuddy WaterTip: <span  th:text="${plant.getWater_tip}"></span></p>
                    </div>
                </div>
            </div>
            <div th:unless="${not #lists.isEmpty(outdoorPlants)}">

            </div>

        </form>
    </div>
</div>
<!-- End Page Container -->

<!-- footer start -->
<footer th:replace="partials/footer :: footer"></footer>
<!-- footer end -->
</body>
</html>